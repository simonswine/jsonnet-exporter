local test1 = { body: |||
  <!DOCTYPE html>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n<!--[if lt IE 9]><html class=\\\"ie8\\\" lang=\\\"en\\\"><![endif]-->\\n<!--[if IE 9]><html class=\\\"ie9\\\" lang=\\\"en\\\"><![endif]-->\\n<!--[if gt IE 9]><!--><html lang=\\\"en\\\"><!--<![endif]-->\\n  <head>\\n    <meta charset=\\\"utf-8\\\">\\n    <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=edge\\\">\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1, shrink-to-fit=no\\\">\\n    <meta name=\\\"description\\\" content=\\\"Book your coronavirus (COVID-19) vaccination appointments using this service.\\\">\\n    <link rel=\\\"canonical\\\" href=\\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/book-coronavirus-vaccination/\\\">\\n\\n    \\n\\n    <title>Book a coronavirus vaccination - NHS</title>\\n\\n    <link href=\\\"https://assets.nhs.uk/\\\" rel=\\\"preconnect\\\" crossorigin>\\n    <link type=\\\"font/woff2\\\" href=\\\"https://assets.nhs.uk/fonts/FrutigerLTW01-55Roman.woff2\\\" rel=\\\"preload\\\" as=\\\"font\\\" crossorigin>\\n    <link type=\\\"font/woff2\\\" href=\\\"https://assets.nhs.uk/fonts/FrutigerLTW01-65Bold.woff2\\\" rel=\\\"preload\\\" as=\\\"font\\\" crossorigin>\\n\\n    <link rel=\\\"stylesheet\\\" href=\\\"/static/nhsuk/css/main.9943db5d0dda.css\\\" type=\\\"text/css\\\" />\\n\\n    \\n      \\n    \\n\\n    \\n      <script type=\\\"application/ld+json\\\">{\\\"@context\\\": \\\"http://schema.org\\\", \\\"@type\\\": \\\"WebPage\\\", \\\"about\\\": {\\\"@type\\\": \\\"WebPage\\\", \\\"name\\\": \\\"Book or manage your coronavirus (COVID-19) vaccination\\\"}, \\\"author\\\": {\\\"@type\\\": \\\"Organization\\\", \\\"email\\\": \\\"nhswebsite.servicedesk@nhs.net\\\", \\\"logo\\\": \\\"https://www.nhs.uk/nhscwebservices/documents/logo1.jpg\\\", \\\"name\\\": \\\"NHS website\\\", \\\"url\\\": \\\"https://www.nhs.uk\\\"}, \\\"breadcrumb\\\": {\\\"@context\\\": \\\"http://schema.org\\\", \\\"@type\\\": \\\"BreadcrumbList\\\", \\\"itemListElement\\\": [{\\\"@type\\\": \\\"ListItem\\\", \\\"item\\\": {\\\"@id\\\": \\\"https://www.nhs.uk/conditions/\\\", \\\"genre\\\": \\\"condition\\\", \\\"name\\\": \\\"Health A to Z\\\"}, \\\"position\\\": 0}, {\\\"@type\\\": \\\"ListItem\\\", \\\"item\\\": {\\\"@id\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/\\\", \\\"genre\\\": \\\"hub\\\", \\\"name\\\": \\\"Coronavirus (COVID-19)\\\"}, \\\"position\\\": 1}, {\\\"@type\\\": \\\"ListItem\\\", \\\"item\\\": {\\\"@id\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/\\\", \\\"genre\\\": \\\"hub\\\", \\\"name\\\": \\\"Coronavirus (COVID-19) vaccination\\\"}, \\\"position\\\": 2}, {\\\"@type\\\": \\\"ListItem\\\", \\\"item\\\": {\\\"@id\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/book-coronavirus-vaccination/\\\", \\\"genre\\\": \\\"guide\\\", \\\"name\\\": \\\"Book or manage your coronavirus (COVID-19) vaccination\\\"}, \\\"position\\\": 3}]}, \\\"copyrightHolder\\\": {\\\"@type\\\": \\\"Organization\\\", \\\"name\\\": \\\"Crown Copyright\\\"}, \\\"description\\\": \\\"Book your coronavirus (COVID-19) vaccination appointments using this service.\\\", \\\"genre\\\": \\\"guide\\\", \\\"hasPart\\\": [], \\\"lastReviewed\\\": [\\\"2021-05-14T13:12:00+00:00\\\", \\\"2023-05-14T13:12:00+00:00\\\"], \\\"license\\\": \\\"https://developer.api.nhs.uk/terms\\\", \\\"name\\\": \\\"Book or manage your coronavirus (COVID-19) vaccination\\\", \\\"relatedLink\\\": [{\\\"@type\\\": \\\"LinkRole\\\", \\\"linkRelationship\\\": \\\"Navigation\\\", \\\"name\\\": \\\"Coronavirus (COVID-19) vaccination\\\", \\\"position\\\": 0, \\\"url\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/\\\"}, {\\\"@type\\\": \\\"LinkRole\\\", \\\"linkRelationship\\\": \\\"Navigation\\\", \\\"name\\\": \\\"Coronavirus (COVID-19) vaccine\\\", \\\"position\\\": 1, \\\"url\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/coronavirus-vaccine/\\\"}, {\\\"@type\\\": \\\"LinkRole\\\", \\\"linkRelationship\\\": \\\"Navigation\\\", \\\"name\\\": \\\"Who can get the coronavirus (COVID-19) vaccine\\\", \\\"position\\\": 2, \\\"url\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/who-can-get-the-vaccine/\\\"}, {\\\"@type\\\": \\\"LinkRole\\\", \\\"linkRelationship\\\": \\\"Navigation\\\", \\\"name\\\": \\\"How you will be contacted for your coronavirus (COVID-19) vaccination\\\", \\\"position\\\": 3, \\\"url\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/how-you-will-be-contacted/\\\"}, {\\\"@type\\\": \\\"LinkRole\\\", \\\"linkRelationship\\\": \\\"Navigation\\\", \\\"name\\\": \\\"Book or manage your coronavirus (COVID-19) vaccination\\\", \\\"position\\\": 4, \\\"url\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/book-coronavirus-vaccination/\\\"}, {\\\"@type\\\": \\\"LinkRole\\\", \\\"linkRelationship\\\": \\\"Navigation\\\", \\\"name\\\": \\\"What happens at your coronavirus (COVID-19) vaccination appointment\\\", \\\"position\\\": 5, \\\"url\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/what-happens-at-your-appointment/\\\"}, {\\\"@type\\\": \\\"LinkRole\\\", \\\"linkRelationship\\\": \\\"Navigation\\\", \\\"name\\\": \\\"Health conditions and coronavirus (COVID-19) vaccination\\\", \\\"position\\\": 6, \\\"url\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/health-conditions/\\\"}, {\\\"@type\\\": \\\"LinkRole\\\", \\\"linkRelationship\\\": \\\"Navigation\\\", \\\"name\\\": \\\"Coronavirus (COVID-19) vaccination status for travelling abroad\\\", \\\"position\\\": 7, \\\"url\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/vaccination-status-for-travelling-abroad/\\\"}], \\\"schemaVersion\\\": [\\\"http://schema.org/version/3.9/\\\", \\\"g-20190515\\\"], \\\"url\\\": \\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/book-coronavirus-vaccination/\\\"}</script>\\n    \\n\\n    \\n      \\n    \\n\\n    <link rel=\\\"shortcut icon\\\" href=\\\"/static/nhsuk/img/favicons/favicon.68c7f017cfba.ico\\\" type=\\\"image/x-icon\\\">\\n    <link rel=\\\"apple-touch-icon\\\" href=\\\"/static/nhsuk/img/favicons/apple-touch-icon-180x180.15a5044def06.png\\\">\\n    <link rel=\\\"mask-icon\\\" href=\\\"/static/nhsuk/img/favicons/favicon.25bc75538faa.svg\\\" color=\\\"#005eb8\\\">\\n    <link rel=\\\"icon\\\" sizes=\\\"192x192\\\" href=\\\"/static/nhsuk/img/favicons/favicon-192x192.43924bfe6c7e.png\\\">\\n    <meta name=\\\"msapplication-TileImage\\\" content=\\\"/static/nhsuk/img/favicons/mediumtile-144x144.cf4985872492.png\\\">\\n    <meta name=\\\"msapplication-TileColor\\\" content=\\\"#005eb8\\\">\\n    <meta name=\\\"msapplication-square70x70logo\\\" content=\\\"/static/nhsuk/img/favicons/smalltile-70x70.29f75b06cf75.png\\\">\\n    <meta name=\\\"msapplication-square150x150logo\\\" content=\\\"/static/nhsuk/img/favicons/mediumtile-150x150.89688d93af5b.png\\\">\\n    <meta name=\\\"msapplication-wide310x150logo\\\" content=\\\"/static/nhsuk/img/favicons/widetile-310x150.535c3996630d.png\\\">\\n    <meta name=\\\"msapplication-square310x310logo\\\" content=\\\"/static/nhsuk/img/favicons/largetile-310x310.294742e00ff4.png\\\">\\n\\n    \\n\\n    \\n      <meta property=\\\"og:url\\\" content=\\\"https://www.nhs.uk/conditions/coronavirus-covid-19/coronavirus-vaccination/book-coronavirus-vaccination/\\\">\\n      <meta property=\\\"og:site_name\\\" content=\\\"nhs.uk\\\">\\n      <meta property=\\\"og:title\\\" content=\\\"Book a coronavirus vaccination\\\"/>\\n      <meta property=\\\"og:description\\\" content=\\\"Book your coronavirus (COVID-19) vaccination appointments using this service.\\\">\\n      <meta property=\\\"og:type\\\" content=\\\"website\\\">\\n      <meta property=\\\"og:locale\\\" content=\\\"en_GB\\\">\\n      <meta property=\\\"og:image\\\" content=\\\"https://www.nhs.uk/static/nhsuk/img/default-social-image.a74435697f45.png\\\">\\n      <meta property=\\\"og:image:alt\\\" content=\\\"nhs.uk\\\"/>\\n      <meta property=\\\"article:author\\\" content=\\\"https://www.facebook.com/nhswebsite/\\\">\\n      <meta property=\\\"article:modified_time\\\" content=\\\"18 May 2021, 6:47 a.m.\\\">\\n      <meta property=\\\"article:published_time\\\" content=\\\"8 Jan 2021, 2:02 p.m.\\\">\\n      \\n      <meta name=\\\"twitter:card\\\" content=\\\"summary_large_image\\\">\\n      <meta name=\\\"twitter:site\\\" content=\\\"@nhsuk\\\">\\n      <meta name=\\\"twitter:creator\\\" content=\\\"@nhsuk\\\">\\n      <meta name=\\\"twitter:image:alt\\\" content=\\\"nhs.uk\\\"/>\\n    \\n\\n\\n    <script src=\\\"/static/nhsuk/js/main.4e239eb7fb21.js\\\" defer></script>\\n\\n    \\n      <script src=\\\"https://assets.nhs.uk/scripts/cookie-consent.js\\\" defer></script>\\n    \\n\\n    \\n\\n    \\n      <script type=\\\"application/javascript\\\">window.digitalData=\\n            {\\\"page\\\": {\\n                \\\"pageInfo\\\": {\\n                    \\\"pageName\\\": \\\"nhs:web:conditions:coronavirus-covid-19:coronavirus-vaccination:book-coronavirus-vaccination\\\"\\n               },\\n                \\\"category\\\":\\n                    {\\n            \\\"primaryCategory\\\": \\\"conditions\\\",\\n            \\\"subCategory1\\\":\\\"coronavirus-covid-19\\\",\\n            \\\"subCategory2\\\":\\\"coronavirus-vaccination\\\",\\n            \\\"subCategory3\\\":\\\"book-coronavirus-vaccination\\\"\\n            }\\n                },\\n               };\\n            </script>\\n      \\n      <script src=\\\"//assets.adobedtm.com/launch-ENe7f6cdd7cc05409b86547d9153429788.min.js\\\" type=\\\"text/plain\\\" data-cookieconsent=\\\"statistics\\\" async></script>\\n    \\n\\n    \\n      \\n      <script type=\\\"text/plain\\\" data-cookieconsent=\\\"statistics\\\">\\n        (function (h, o, t, j, a, r) {\\n          h.hj = h.hj || function () {\\n            (h.hj.q = h.hj.q || []).push(arguments)\\n          };\\n          h._hjSettings = {\\n            hjid: 681718,\\n            hjsv: 6,\\n          };\\n          a = o.getElementsByTagName(\'head\')[0];\\n          r = o.createElement(\'script\');\\n          r.async = 1;\\n          r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;\\n          a.appendChild(r);\\n        })(window, document, \'//static.hotjar.com/c/hotjar-\', \'.js?sv=\');\\n      </script>\\n    \\n\\n    <script>\\n      window.NHSUK_SETTINGS = {};\\n      window.NHSUK_SETTINGS.BANNER_API_URL = \\\"//www.nhs.uk/externalservices/surveyfeedapi/api/bannerfeed\\\";\\n      window.NHSUK_SETTINGS.BANNER_TEST_API_URL = \\\"//www.nhs.uk/externalservices/surveyfeedapi/api/testfeed\\\";\\n      \\n        window.NHSUK_SETTINGS.EMERGENCY_ALERT_DISABLED = true;\\n      \\n      window.NHSUK_SETTINGS.SUGGESTIONS_TEST_HOST = \\\"//api.nhs.uk/site-search/autocomplete\\\";\\n      window.NHSUK_SETTINGS.SEARCH_TEST_HOST = \\\"//nhs.uk/search/results\\\";\\n      window.NHSUK_SETTINGS.USER_FEEDBACK_STORE_ENDPOINT = \\\"https://nhsuk-user-feedback-func-prod-uks.azurewebsites.net/\\\";\\n    </script>  \\n\\n    \\n  </head>\\n\\n  <body class=\\\"\\\">\\n    \\n\\n    \\n      <a class=\\\"nhsuk-skip-link\\\" href=\\\"#maincontent\\\">Skip to main content</a>\\n\\n\\n      \\n\\n\\n<header class=\\\"nhsuk-header\\\" role=\\\"banner\\\">\\n  <div class=\\\"nhsuk-width-container nhsuk-header__container\\\">\\n    <div class=\\\"nhsuk-header__logo\\\">\\n  <a class=\\\"nhsuk-header__link\\\" href=\\\"/\\\" aria-label=\\\"NHS homepage\\\">\\n    <svg class=\\\"nhsuk-logo nhsuk-logo--white\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" role=\\\"presentation\\\" focusable=\\\"false\\\" viewBox=\\\"0 0 40 16\\\">\\n      <path fill=\\\"#fff\\\" d=\\\"M0 0h40v16H0z\\\"></path>\\n      <path fill=\\\"#005eb8\\\" d=\\\"M3.9 1.5h4.4l2.6 9h.1l1.8-9h3.3l-2.8 13H9l-2.7-9h-.1l-1.8 9H1.1M17.3 1.5h3.6l-1 4.9h4L25 1.5h3.5l-2.7 13h-3.5l1.1-5.6h-4.1l-1.2 5.6h-3.4M37.7 4.4c-.7-.3-1.6-.6-2.9-.6-1.4 0-2.5.2-2.5 1.3 0 1.8 5.1 1.2 5.1 5.1 0 3.6-3.3 4.5-6.4 4.5-1.3 0-2.9-.3-4-.7l.8-2.7c.7.4 2.1.7 3.2.7s2.8-.2 2.8-1.5c0-2.1-5.1-1.3-5.1-5 0-3.4 2.9-4.4 5.8-4.4 1.6 0 3.1.2 4 .6\\\"></path>\\n      <image src=\\\"https://assets.nhs.uk/images/nhs-logo.png\\\" xlink:href=\\\"\\\"></image>\\n    </svg>\\n    \\n  </a>\\n</div>\\n\\n\\n    \\n      <div class=\\\"nhsuk-header__content\\\" id=\\\"content-header\\\">\\n        \\n          <div class=\\\"nhsuk-header__menu\\\">\\n  <button class=\\\"nhsuk-header__menu-toggle\\\" id=\\\"toggle-menu\\\" aria-controls=\\\"header-navigation\\\" aria-label=\\\"Open menu\\\">Menu</button>\\n</div>\\n\\n        \\n\\n        <div class=\\\"nhsuk-header__search\\\">\\n            <div class=\\\"nhsuk-header__search-wrap beta-header__search-wrap js-show\\\" id=\\\"wrap-search\\\">\\n              <form class=\\\"nhsuk-header__search-form beta-header__search-form\\\" id=\\\"search\\\" action=\\\"/search/\\\" method=\\\"get\\\" role=\\\"search\\\">\\n                <label class=\\\"nhsuk-u-visually-hidden\\\" for=\\\"search-field\\\">Search the NHS website</label>\\n                <div class=\\\"autocomplete-container\\\" id=\\\"autocomplete-container\\\"></div>\\n                <input class=\\\"nhsuk-search__input\\\" id=\\\"search-field\\\" name=\\\"q\\\" type=\\\"search\\\" placeholder=\\\"Search\\\" autocomplete=\\\"off\\\" >\\n                <button class=\\\"nhsuk-search__submit beta-search__submit\\\" type=\\\"submit\\\">\\n                  <svg class=\\\"nhsuk-icon nhsuk-icon__search beta-icon__search\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" aria-hidden=\\\"true\\\" focusable=\\\"false\\\">\\n                    <path d=\\\"M19.71 18.29l-4.11-4.1a7 7 0 1 0-1.41 1.41l4.1 4.11a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42zM5 10a5 5 0 1 1 5 5 5 5 0 0 1-5-5z\\\"></path>\\n                  </svg>\\n                  <span class=\\\"nhsuk-u-visually-hidden\\\">Search</span>\\n                </button>\\n              </form>\\n            </div>\\n          </div>\\n      </div>\\n    \\n\\n  </div>\\n\\n  \\n    <nav class=\\\"nhsuk-header__navigation\\\" id=\\\"header-navigation\\\" role=\\\"navigation\\\" aria-label=\\\"Primary navigation\\\" aria-labelledby=\\\"label-navigation\\\">\\n  <p class=\\\"nhsuk-header__navigation-title\\\"><span id=\\\"label-navigation\\\">Menu</span>\\n    <button class=\\\"nhsuk-header__navigation-close\\\" id=\\\"close-menu\\\">\\n      <svg class=\\\"nhsuk-icon nhsuk-icon__close\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" aria-hidden=\\\"true\\\" focusable=\\\"false\\\">\\n        <path d=\\\"M13.41 12l5.3-5.29a1 1 0 1 0-1.42-1.42L12 10.59l-5.29-5.3a1 1 0 0 0-1.42 1.42l5.3 5.29-5.3 5.29a1 1 0 0 0 0 1.42 1 1 0 0 0 1.42 0l5.29-5.3 5.29 5.3a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42z\\\"></path>\\n      </svg>\\n      <span class=\\\"nhsuk-u-visually-hidden\\\">Close menu</span>\\n    </button>\\n  </p>\\n  <ul class=\\\"nhsuk-header__navigation-list\\\">\\n    <li class=\\\"nhsuk-header__navigation-item nhsuk-header__navigation-item--for-mobile\\\">\\n      <a class=\\\"nhsuk-header__navigation-link\\\" href=\\\"/\\\" >\\n        Home\\n        <svg class=\\\"nhsuk-icon nhsuk-icon__chevron-right\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" aria-hidden=\\\"true\\\">\\n          <path d=\\\"M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z\\\"></path>\\n        </svg>\\n      </a>\\n    </li>\\n    \\n      <li class=\\\"nhsuk-header__navigation-item\\\">\\n  <a class=\\\"nhsuk-header__navigation-link\\\" href=\\\"/conditions/\\\" >\\n    Health A-Z\\n    <svg class=\\\"nhsuk-icon nhsuk-icon__chevron-right\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" aria-hidden=\\\"true\\\">\\n      <path d=\\\"M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z\\\"></path>\\n    </svg>\\n  </a>\\n</li>\\n\\n    \\n      <li class=\\\"nhsuk-header__navigation-item\\\">\\n  <a class=\\\"nhsuk-header__navigation-link\\\" href=\\\"/live-well/\\\" >\\n    Live Well\\n    <svg class=\\\"nhsuk-icon nhsuk-icon__chevron-right\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" aria-hidden=\\\"true\\\">\\n      <path d=\\\"M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z\\\"></path>\\n    </svg>\\n  </a>\\n</li>\\n\\n    \\n      <li class=\\\"nhsuk-header__navigation-item\\\">\\n  <a class=\\\"nhsuk-header__navigation-link\\\" href=\\\"/mental-health/\\\" >\\n    Mental health\\n    <svg class=\\\"nhsuk-icon nhsuk-icon__chevron-right\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" aria-hidden=\\\"true\\\">\\n      <path d=\\\"M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z\\\"></path>\\n    </svg>\\n  </a>\\n</li>\\n\\n    \\n      <li class=\\\"nhsuk-header__navigation-item\\\">\\n  <a class=\\\"nhsuk-header__navigation-link\\\" href=\\\"/conditions/social-care-and-support-guide/\\\" >\\n    Care and support\\n    <svg class=\\\"nhsuk-icon nhsuk-icon__chevron-right\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" aria-hidden=\\\"true\\\">\\n      <path d=\\\"M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z\\\"></path>\\n    </svg>\\n  </a>\\n</li>\\n\\n    \\n      <li class=\\\"nhsuk-header__navigation-item\\\">\\n  <a class=\\\"nhsuk-header__navigation-link\\\" href=\\\"/pregnancy/\\\" >\\n    Pregnancy\\n    <svg class=\\\"nhsuk-icon nhsuk-icon__chevron-right\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" aria-hidden=\\\"true\\\">\\n      <path d=\\\"M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z\\\"></path>\\n    </svg>\\n  </a>\\n</li>\\n\\n    \\n      <li class=\\\"nhsuk-header__navigation-item\\\">\\n  <a class=\\\"nhsuk-header__navigation-link\\\" href=\\\"/nhs-services/\\\" >\\n    NHS services\\n    <svg class=\\\"nhsuk-icon nhsuk-icon__chevron-right\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" aria-hidden=\\\"true\\\">\\n      <path d=\\\"M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z\\\"></path>\\n    </svg>\\n  </a>\\n</li>\\n\\n    \\n  </ul>\\n</nav>\\n\\n  \\n</header>\\n    \\n\\n    \\n  \\n\\n\\n\\n<nav class=\\\"nhsuk-breadcrumb beta-breadcrumb\\\" aria-label=\\\"Breadcrumb\\\">\\n  <div class=\\\"nhsuk-width-container\\\">\\n    <ol class=\\\"nhsuk-breadcrumb__list\\\">\\n      \\n      <li class=\\\"nhsuk-breadcrumb__item\\\">\\n          <a href=\\\"/\\\" class=\\\"nhsuk-breadcrumb__link\\\">Home</a>\\n        </li>\\n        \\n      <li class=\\\"nhsuk-breadcrumb__item\\\">\\n          <a href=\\\"/conditions/\\\" class=\\\"nhsuk-breadcrumb__link\\\">Health A to Z</a>\\n        </li>\\n        \\n      <li class=\\\"nhsuk-breadcrumb__item\\\">\\n          <a href=\\\"/conditions/coronavirus-covid-19/\\\" class=\\\"nhsuk-breadcrumb__link\\\">Coronavirus (COVID-19)</a>\\n        </li>\\n        \\n      <li class=\\\"nhsuk-breadcrumb__item\\\">\\n          <a href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/\\\" class=\\\"nhsuk-breadcrumb__link\\\">Coronavirus (COVID-19) vaccination</a>\\n        </li>\\n        \\n      </ol>\\n\\n      <p class=\\\"nhsuk-breadcrumb__back\\\">\\n        \\n          <a href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/\\\" class=\\\"nhsuk-breadcrumb__backlink\\\">\\n            <span class=\\\"nhsuk-u-visually-hidden\\\">Back to </span>\\n            Coronavirus (COVID-19) vaccination\\n          </a>\\n        \\n      </p>\\n    </div>\\n  </nav>\\n\\n\\n\\n\\n    \\n\\n    <div class=\\\"nhsuk-width-container\\\">\\n        <main class=\\\"nhsuk-main-wrapper nhsuk-u-padding-top-0\\\" id=\\\"maincontent\\\"  lang=\\\"en-GB\\\"  >\\n        \\n  <div class=\\\"nhsuk-grid-row\\\">\\n    <div class=\\\"nhsuk-grid-column-two-thirds\\\">\\n\\n      \\n  <h1>Book or manage your coronavirus (COVID-19) vaccination</h1>\\n\\n\\n    </div>\\n  </div>\\n\\n  <article>\\n    <div class=\\\"nhsuk-grid-row\\\">\\n      <div class=\\\"nhsuk-grid-column-two-thirds\\\">\\n\\n        \\n  \\n    \\n\\n\\n  <section>\\n    \\n\\n    \\n\\n    \\n\\n      \\n        <p><b>Use this service to book a coronavirus (COVID-19) vaccination or manage your appointments.</b></p><p>If you&#x27;ve already booked a vaccination appointment through a GP or local NHS service, you do not need to book again using this service.</p>\\n      \\n  </section>\\n\\n\\n  \\n    \\n\\n\\n  <section>\\n    \\n\\n    \\n\\n    \\n\\n      \\n        <h2>Who can use this service</h2><p>You can only use this service if any of the following apply:</p><ul><li>you&#x27;re aged 36 or over</li><li>you&#x27;ll turn 36 before 1 July 2021</li><li>you&#x27;re at <a href=\\\"/conditions/coronavirus-covid-19/people-at-higher-risk/who-is-at-high-risk-from-coronavirus-clinically-extremely-vulnerable/\\\">high risk from COVID-19</a> (clinically extremely vulnerable)</li><li>you have a condition that puts you at higher risk (clinically vulnerable)</li><li>you have a learning disability</li><li>you&#x27;re a frontline health or social care worker</li><li>you get a Carer&#x27;s Allowance, get support following an assessment by your local authority or your GP record shows you&#x27;re a carer</li></ul><p>If you&#x27;re an eligible unpaid carer but you cannot book an appointment, speak to your GP surgery.</p><p>Find out more about <a href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/who-can-get-the-vaccine/\\\">who can get the COVID-19 vaccine</a>.</p>\\n      \\n  </section>\\n\\n\\n  \\n    \\n\\n\\n  <section>\\n    \\n\\n    \\n\\n    \\n\\n      \\n        <h2>Book your appointments</h2><p>You need to:</p><ul><li>have 2 doses of the COVID-19 vaccine at 2 appointments</li><li>book both appointments at the same time</li><li>get the 2nd dose 8 to 12 weeks after getting your 1st dose</li></ul><p>If you&#x27;ve had a positive COVID-19 test, you should wait 4 weeks from the date you had the test before you book an appointment.</p><p>When you book you&#x27;ll only be offered appointments for vaccines that are recommended for you based on your age, any underlying health conditions, and whether you&#x27;re pregnant.</p>\\n      \\n        \\n\\n<a href=\\\"https://www.nhs.uk/book-a-coronavirus-vaccination/do-you-have-an-nhs-number\\\" role=\\\"button\\\" draggable=\\\"false\\\" class=\\\"nhsuk-button \\\">\\n  Book my appointments\\n</a>\\n\\n      \\n  </section>\\n\\n\\n  \\n    \\n\\n\\n  <section>\\n    \\n\\n    \\n\\n    \\n\\n      \\n        <h2>Manage your appointments</h2><p>If you already have appointments booked, you can:</p><ul><li>view your appointments</li><li>cancel your appointments</li><li>book appointments again</li></ul><p>We will ask you some questions first, so we can find your bookings.</p>\\n      \\n        <div class=\\\"nhsuk-warning-callout\\\">\\n  <h3 class=\\\"nhsuk-warning-callout__label\\\">\\n    \\n      <span role=\\\"text\\\">\\n        <span class=\\\"nhsuk-u-visually-hidden\\\">Important: </span>\\n        Important\\n      </span>\\n    \\n  </h3>\\n  <p>We&#x27;ll be contacting some people directly to bring forward their appointment for the 2nd dose of the COVID-19 vaccine.</p><p>This is so people at greater risk of getting seriously ill due to coronavirus can get maximum protection earlier.</p><p>Please wait to be contacted if you think you&#x27;re in this group.</p>\\n</div>\\n\\n      \\n        \\n\\n<a href=\\\"https://www.nhs.uk/book-a-coronavirus-vaccination/do-you-have-an-nhs-number\\\" role=\\\"button\\\" draggable=\\\"false\\\" class=\\\"nhsuk-button nhsuk-button--secondary\\\">\\n  Manage my appointments\\n</a>\\n\\n      \\n  </section>\\n\\n\\n  \\n    \\n\\n\\n  <section>\\n    \\n\\n    \\n\\n    \\n\\n      \\n        <h2>About using this service</h2><p>By using this service you&#x27;re agreeing to our <a href=\\\"/our-policies/terms-and-conditions/\\\">terms of use</a> and <a href=\\\"/our-policies/nbs-privacy-policy/\\\">privacy policy</a>.</p><p>You can use this service for someone else if they give you permission.</p><p>If you put someone&#x27;s details in without their consent:</p><ul><li>you will be breaching the terms of use for this service</li><li>you may be committing a criminal offence</li></ul><p>You must be registered with a GP surgery in England to use this service. You can <a href=\\\"/nhs-services/gps/how-to-register-with-a-gp-surgery/\\\">register with a GP</a> if you do not have one.</p>\\n      \\n  </section>\\n\\n\\n  \\n\\n\\n      </div>\\n\\n      \\n\\n    </div>\\n  </article>\\n\\n  \\n\\n  \\n    <aside class=\\\"nhsuk-grid-column\\\">\\n      <div id=\\\"sibling-nav\\\" class=\\\"app-related-nav beta-hub-sibling-nav nhsuk-u-padding-top-5\\\">\\n        <h2 class=\\\"app-related-nav__heading nhsuk-u-padding-bottom-3\\\">\\n          More in\\n          \\n            <a href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/\\\">Coronavirus (COVID-19) vaccination</a>\\n          \\n        </h2>\\n        <nav role=\\\"navigation\\\" class=\\\"app-related-nav__nav-section\\\">\\n          <ul class=\\\"app-related-nav__list beta-hub-sibling-nav__list\\\">\\n            \\n              \\n                <li class=\\\"beta-hub-sibling-nav__item\\\">\\n                  <a class=\\\"app-related-nav__link\\\" href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/coronavirus-vaccine/\\\">\\n                    COVID-19 vaccine\\n                  </a>\\n                </li>\\n              \\n            \\n              \\n                <li class=\\\"beta-hub-sibling-nav__item\\\">\\n                  <a class=\\\"app-related-nav__link\\\" href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/who-can-get-the-vaccine/\\\">\\n                    Who can get the vaccine\\n                  </a>\\n                </li>\\n              \\n            \\n              \\n                <li class=\\\"beta-hub-sibling-nav__item\\\">\\n                  <a class=\\\"app-related-nav__link\\\" href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/how-you-will-be-contacted/\\\">\\n                    How you will be contacted\\n                  </a>\\n                </li>\\n              \\n            \\n              \\n                <li class=\\\"beta-hub-sibling-nav__item\\\">\\n                  <a class=\\\"app-related-nav__link\\\" href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/what-happens-at-your-appointment/\\\">\\n                    What happens at your appointment\\n                  </a>\\n                </li>\\n              \\n            \\n              \\n                <li class=\\\"beta-hub-sibling-nav__item\\\">\\n                  <a class=\\\"app-related-nav__link\\\" href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/health-conditions/\\\">\\n                    Health conditions and COVID-19 vaccination\\n                  </a>\\n                </li>\\n              \\n            \\n              \\n                <li class=\\\"beta-hub-sibling-nav__item\\\">\\n                  <a class=\\\"app-related-nav__link\\\" href=\\\"/conditions/coronavirus-covid-19/coronavirus-vaccination/vaccination-status-for-travelling-abroad/\\\">\\n                    Vaccination status for travelling abroad\\n                  </a>\\n                </li>\\n              \\n            \\n          </ul>\\n        </nav>\\n      </div>\\n    </aside>\\n  \\n\\n  <div class=\\\"nhsuk-review-date\\\">\\n    <p class=\\\"nhsuk-body-s\\\">\\n      Page last reviewed: 14 May 2021\\n      <br>\\n      Next review due: 14 May 2023\\n    </p>\\n  </div>\\n\\n\\n\\n        \\n      </main>\\n    </div>\\n\\n    \\n\\n    \\n      \\n\\n\\n<footer role=\\\"contentinfo\\\">\\n  <div class=\\\"nhsuk-footer\\\" id=\\\"nhsuk-footer\\\">\\n    <div class=\\\"nhsuk-width-container\\\">\\n      <h2 class=\\\"nhsuk-u-visually-hidden\\\">Support links</h2>\\n      <ul class=\\\"nhsuk-footer__list nhsuk-footer__list--three-columns\\\">\\n        \\n          <li class=\\\"nhsuk-footer__list-item\\\"><a href=\\\"/nhs-sites/\\\" class=\\\"nhsuk-footer__list-item-link\\\">NHS sites</a></li>\\n        \\n          <li class=\\\"nhsuk-footer__list-item\\\"><a href=\\\"/about-us/\\\" class=\\\"nhsuk-footer__list-item-link\\\">About us</a></li>\\n        \\n          <li class=\\\"nhsuk-footer__list-item\\\"><a href=\\\"/contact-us/\\\" class=\\\"nhsuk-footer__list-item-link\\\">Contact us</a></li>\\n        \\n          <li class=\\\"nhsuk-footer__list-item\\\"><a href=\\\"/personalisation/login.aspx\\\" class=\\\"nhsuk-footer__list-item-link\\\">Profile editor login</a></li>\\n        \\n          <li class=\\\"nhsuk-footer__list-item\\\"><a href=\\\"/about-us/site-map/\\\" class=\\\"nhsuk-footer__list-item-link\\\">Site map</a></li>\\n        \\n

||| };

local find_age_find(s) =
  local words = std.split(s, ' ');
  local matches = std.find('aged', words);

  if (std.length(matches) == 0) then null else std.parseInt(words[matches[0] + 1])
;

local find_age_filter(s) =
  local needle = ' aged ';
  local needle_len = std.length(needle);

  local matches(x) = std.substr(s, x, needle_len) == needle;

  local pos = std.filter(matches, std.range(0, std.length(s) - needle_len));

  std.parseInt(
  );


local find_age_foldl_slow(s) =
  local needle = ' aged ';
  local needle_len = std.length(needle);

  local matches(x) = std.substr(s, x, needle_len) == needle;

  local range = std.range(0, std.length(s) - needle_len);

  local result = std.foldl(function(y, pos)
    if std.length(y) > 0 then
      y
    else if matches(pos)
    then std.split(std.substr(s, pos + needle_len, 3), ' ')[0]
    else y, range, '');

  std.parseInt(result);

// use native regex function
local find_age(s) =
  local result = std.native('regexMatch')(' aged (\\d+)', s);

  if std.length(result) < 1 then null
  else
    if std.length(result[0]) < 2 then null
    else
      local val = result[0][1];
      if val == null then null
      else std.parseInt(val)
;

{
  process(input):: {
    nhs_vaccine_age: {
      type: 'gauge',
      help: 'a hello world metric',
      series: [{
        value: find_age_foldl_slow(input.body),
      }],
    },
  },

  test1: $.process(test1),
  test2: $.process({ body: 'x aged 34 and over' }),
}
